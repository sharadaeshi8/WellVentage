"use client";
import Link from "next/link";
import { usePathname, useRouter } from "next/navigation";
import React, { useEffect, useState } from "react";
import { authService } from "@/lib/services";
import type { User } from "@/lib/types";

const items = [
  {
    href: "/dashboard",
    label: "Dashboard",
    icon: (
      <svg
        width="18"
        height="16"
        viewBox="0 0 20 16"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        className="fill-inherit"
      >
        <path d="M13.7691 15.7361C13.4905 15.7361 13.257 15.6417 13.0689 15.4529C12.8807 15.2641 12.7863 15.0306 12.7856 14.7526V9.83509C12.7856 9.55643 12.88 9.32301 13.0689 9.13483C13.2577 8.94665 13.4911 8.85224 13.7691 8.85158H18.6867C18.9653 8.85158 19.1991 8.946 19.3879 9.13483C19.5767 9.32366 19.6708 9.55708 19.6702 9.83509V14.7526C19.6702 15.0313 19.5758 15.265 19.3869 15.4539C19.1981 15.6427 18.9647 15.7368 18.6867 15.7361H13.7691ZM9.83509 6.88456C9.55643 6.88456 9.32301 6.79015 9.13483 6.60131C8.94665 6.41248 8.85224 6.17906 8.85158 5.90105V0.983509C8.85158 0.704848 8.946 0.471429 9.13483 0.283251C9.32366 0.0950726 9.55708 0.000655673 9.83509 0H18.6867C18.9653 0 19.1991 0.094417 19.3879 0.283251C19.5767 0.472084 19.6708 0.705504 19.6702 0.983509V5.90105C19.6702 6.17971 19.5758 6.41346 19.3869 6.6023C19.1981 6.79113 18.9647 6.88522 18.6867 6.88456H9.83509ZM0.983509 15.7361C0.704848 15.7361 0.471429 15.6417 0.283251 15.4529C0.0950726 15.2641 0.000655673 15.0306 0 14.7526V9.83509C0 9.55643 0.094417 9.32301 0.283251 9.13483C0.472084 8.94665 0.705504 8.85224 0.983509 8.85158H9.83509C10.1137 8.85158 10.3475 8.946 10.5363 9.13483C10.7252 9.32366 10.8193 9.55708 10.8186 9.83509V14.7526C10.8186 15.0313 10.7242 15.265 10.5353 15.4539C10.3465 15.6427 10.1131 15.7368 9.83509 15.7361H0.983509ZM0.983509 6.88456C0.704848 6.88456 0.471429 6.79015 0.283251 6.60131C0.0950726 6.41248 0.000655673 6.17906 0 5.90105V0.983509C0 0.704848 0.094417 0.471429 0.283251 0.283251C0.472084 0.0950726 0.705504 0.000655673 0.983509 0H5.90105C6.17971 0 6.41346 0.094417 6.6023 0.283251C6.79113 0.472084 6.88522 0.705504 6.88456 0.983509V5.90105C6.88456 6.17971 6.79015 6.41346 6.60131 6.6023C6.41248 6.79113 6.17906 6.88522 5.90105 6.88456H0.983509ZM10.8186 4.91754H17.7032V1.96702H10.8186V4.91754ZM1.96702 13.7691H8.85158V10.8186H1.96702V13.7691ZM14.7526 13.7691H17.7032V10.8186H14.7526V13.7691ZM1.96702 4.91754H4.91754V1.96702H1.96702V4.91754Z" />
      </svg>
    ),
  },
  {
    href: "/leads",
    label: "Lead Management",
    icon: (
      <svg
        width="18"
        height="16"
        className="fill-inherit"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path d="M24 15.0004V24.0004H12V15.0004H15V12.0004H21V15.0004H24ZM16.5 15.0004H19.5V13.5004H16.5V15.0004ZM22.5 19.5004H21V21.0004H19.5V19.5004H16.5V21.0004H15V19.5004H13.5V22.5004H22.5V19.5004ZM22.5 16.5004H13.5V18.0004H22.5V16.5004ZM18.3398 10.5004C17.918 10.0238 17.418 9.65662 16.8398 9.3988C16.2617 9.14099 15.6484 9.00818 15 9.00037C14.375 9.00037 13.793 9.11755 13.2539 9.35193C12.7148 9.5863 12.2383 9.90662 11.8242 10.3129C11.4102 10.7191 11.0859 11.1996 10.8516 11.7543C10.6172 12.309 10.5 12.891 10.5 13.5004C10.5 14.2191 10.3398 14.8949 10.0195 15.5277C9.69922 16.1605 9.24609 16.6918 8.66016 17.1215C9.01172 17.3011 9.33984 17.5082 9.64453 17.7426C9.94922 17.9769 10.2344 18.2426 10.5 18.5394V22.5004C10.5 21.8832 10.3828 21.3011 10.1484 20.7543C9.91406 20.2074 9.59375 19.7308 9.1875 19.3246C8.78125 18.9183 8.30078 18.5941 7.74609 18.3519C7.19141 18.1097 6.60938 17.9926 6 18.0004C5.375 18.0004 4.79297 18.1176 4.25391 18.3519C3.71484 18.5863 3.23828 18.9066 2.82422 19.3129C2.41016 19.7191 2.08594 20.1996 1.85156 20.7543C1.61719 21.309 1.5 21.891 1.5 22.5004H0C0 21.9301 0.078125 21.3793 0.234375 20.848C0.390625 20.3168 0.613281 19.8129 0.902344 19.3363C1.19141 18.8597 1.54297 18.4379 1.95703 18.0707C2.37109 17.7035 2.83203 17.3871 3.33984 17.1215C2.76172 16.6996 2.3125 16.1722 1.99219 15.5394C1.67188 14.9066 1.50781 14.2269 1.5 13.5004C1.5 12.8832 1.61719 12.3011 1.85156 11.7543C2.08594 11.2074 2.40625 10.7308 2.8125 10.3246C3.21875 9.91834 3.69531 9.59412 4.24219 9.35193C4.78906 9.10974 5.375 8.99255 6 9.00037C6.71875 9.00037 7.39453 9.16052 8.02734 9.48084C8.66016 9.80115 9.19141 10.2543 9.62109 10.8402C9.91797 10.2543 10.2969 9.73084 10.7578 9.2699C11.2188 8.80896 11.7461 8.42615 12.3398 8.12146C11.7617 7.69959 11.3125 7.17224 10.9922 6.53943C10.6719 5.90662 10.5078 5.22693 10.5 4.50037C10.5 3.88318 10.6172 3.30115 10.8516 2.75427C11.0859 2.2074 11.4063 1.73084 11.8125 1.32459C12.2188 0.918335 12.6953 0.594116 13.2422 0.351929C13.7891 0.109741 14.375 -0.00744629 15 0.000366211C15.6172 0.000366211 16.1992 0.117554 16.7461 0.351929C17.293 0.586304 17.7695 0.906616 18.1758 1.31287C18.582 1.71912 18.9063 2.19959 19.1484 2.75427C19.3906 3.30896 19.5078 3.89099 19.5 4.50037C19.5 5.21912 19.3398 5.8949 19.0195 6.52771C18.6992 7.16052 18.2461 7.69177 17.6602 8.12146C18.1914 8.38709 18.6719 8.71912 19.1016 9.11755C19.5313 9.51599 19.8945 9.97693 20.1914 10.5004H18.3398ZM6 16.5004C6.41406 16.5004 6.80078 16.4222 7.16016 16.266C7.51953 16.1097 7.83984 15.8949 8.12109 15.6215C8.40234 15.348 8.61719 15.0316 8.76563 14.6722C8.91406 14.3129 8.99219 13.9222 9 13.5004C9 13.0863 8.92188 12.6996 8.76563 12.3402C8.60938 11.9808 8.39453 11.6605 8.12109 11.3793C7.84766 11.098 7.53125 10.8832 7.17188 10.7347C6.8125 10.5863 6.42188 10.5082 6 10.5004C5.58594 10.5004 5.19922 10.5785 4.83984 10.7347C4.48047 10.891 4.16016 11.1058 3.87891 11.3793C3.59766 11.6527 3.38281 11.9691 3.23438 12.3285C3.08594 12.6879 3.00781 13.0785 3 13.5004C3 13.9144 3.07813 14.3011 3.23438 14.6605C3.39063 15.0199 3.60547 15.3402 3.87891 15.6215C4.15234 15.9027 4.46875 16.1176 4.82813 16.266C5.1875 16.4144 5.57813 16.4926 6 16.5004ZM12 4.50037C12 4.91443 12.0781 5.30115 12.2344 5.66052C12.3906 6.0199 12.6055 6.34021 12.8789 6.62146C13.1523 6.90271 13.4688 7.11755 13.8281 7.26599C14.1875 7.41443 14.5781 7.49255 15 7.50037C15.4141 7.50037 15.8008 7.42224 16.1602 7.26599C16.5195 7.10974 16.8398 6.8949 17.1211 6.62146C17.4023 6.34802 17.6172 6.03162 17.7656 5.67224C17.9141 5.31287 17.9922 4.92224 18 4.50037C18 4.0863 17.9219 3.69959 17.7656 3.34021C17.6094 2.98084 17.3945 2.66052 17.1211 2.37927C16.8477 2.09802 16.5313 1.88318 16.1719 1.73474C15.8125 1.5863 15.4219 1.50818 15 1.50037C14.5859 1.50037 14.1992 1.57849 13.8398 1.73474C13.4805 1.89099 13.1602 2.10584 12.8789 2.37927C12.5977 2.65271 12.3828 2.96912 12.2344 3.32849C12.0859 3.68787 12.0078 4.07849 12 4.50037Z" />
      </svg>
    ),
  },
  {
    href: "/wellvantagei-leads",
    label: "WellVantage Leads",
    icon: (
      <svg
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M21 6.99984L9 18.9998L3.5 13.4998L4.91 12.0898L9 16.1698L19.59 5.58984L21 6.99984Z"
          fill="black"
        />
      </svg>
    ),
  },
  {
    href: "/members",
    label: "Member Management",
    icon: (
      <svg
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M5.5 7C5.5 6.60603 5.5776 6.21593 5.72836 5.85195C5.87913 5.48797 6.1001 5.15726 6.37868 4.87868C6.65726 4.6001 6.98797 4.37913 7.35195 4.22836C7.71593 4.0776 8.10604 4 8.5 4C8.89397 4 9.28407 4.0776 9.64805 4.22836C10.012 4.37913 10.3427 4.6001 10.6213 4.87868C10.8999 5.15726 11.1209 5.48797 11.2716 5.85195C11.4224 6.21593 11.5 6.60603 11.5 7C11.5 7.79565 11.1839 8.55871 10.6213 9.12132C10.0587 9.68393 9.29565 10 8.5 10C7.70435 10 6.94129 9.68393 6.37868 9.12132C5.81607 8.55871 5.5 7.79565 5.5 7ZM8.5 2C7.17392 2 5.90215 2.52678 4.96447 3.46447C4.02678 4.40215 3.5 5.67392 3.5 7C3.5 8.32608 4.02678 9.59785 4.96447 10.5355C5.90215 11.4732 7.17392 12 8.5 12C9.82608 12 11.0979 11.4732 12.0355 10.5355C12.9732 9.59785 13.5 8.32608 13.5 7C13.5 5.67392 12.9732 4.40215 12.0355 3.46447C11.0979 2.52678 9.82608 2 8.5 2ZM15.5 2H14.5V4H15.5C15.894 4 16.2841 4.0776 16.6481 4.22836C17.012 4.37913 17.3427 4.6001 17.6213 4.87868C17.8999 5.15726 18.1209 5.48797 18.2716 5.85195C18.4224 6.21593 18.5 6.60603 18.5 7C18.5 7.39397 18.4224 7.78407 18.2716 8.14805C18.1209 8.51203 17.8999 8.84274 17.6213 9.12132C17.3427 9.3999 17.012 9.62087 16.6481 9.77164C16.2841 9.9224 15.894 10 15.5 10H14.5V12H15.5C16.8261 12 18.0979 11.4732 19.0355 10.5355C19.9732 9.59785 20.5 8.32608 20.5 7C20.5 5.67392 19.9732 4.40215 19.0355 3.46447C18.0979 2.52678 16.8261 2 15.5 2ZM0 19C0 17.6739 0.526784 16.4021 1.46447 15.4645C2.40215 14.5268 3.67392 14 5 14H12C13.3261 14 14.5979 14.5268 15.5355 15.4645C16.4732 16.4021 17 17.6739 17 19V21H15V19C15 18.2044 14.6839 17.4413 14.1213 16.8787C13.5587 16.3161 12.7957 16 12 16H5C4.20435 16 3.44129 16.3161 2.87868 16.8787C2.31607 17.4413 2 18.2044 2 19V21H0V19ZM24 19C24 18.3434 23.8707 17.6932 23.6194 17.0866C23.3681 16.48 22.9998 15.9288 22.5355 15.4645C22.0712 15.0002 21.52 14.6319 20.9134 14.3806C20.3068 14.1293 19.6566 14 19 14H18V16H19C19.7957 16 20.5587 16.3161 21.1213 16.8787C21.6839 17.4413 22 18.2044 22 19V21H24V19Z"
          fill="#333333"
        />
      </svg>
    ),
  },
  {
    href: "/memberships",
    label: "Membership Management",
    icon: (
      <svg
        width="21"
        height="24"
        viewBox="0 0 21 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <g clipPath="url(#clip0_497_979)">
          <path
            d="M4.5 6C4.5 7.5913 5.13214 9.11742 6.25736 10.2426C7.38258 11.3679 8.9087 12 10.5 12C12.0913 12 13.6174 11.3679 14.7426 10.2426C15.8679 9.11742 16.5 7.5913 16.5 6C16.5 4.4087 15.8679 2.88258 14.7426 1.75736C13.6174 0.632141 12.0913 0 10.5 0C8.9087 0 7.38258 0.632141 6.25736 1.75736C5.13214 2.88258 4.5 4.4087 4.5 6ZM8.92969 15.3844L9.80156 16.8375L8.24063 22.6453L6.55313 15.7594C6.45938 15.3797 6.09375 15.1312 5.71406 15.2297C2.43281 16.05 0 19.0219 0 22.5609C0 23.3578 0.646875 24 1.43906 24H19.5609C20.3578 24 21 23.3531 21 22.5609C21 19.0219 18.5672 16.05 15.2859 15.2297C14.9062 15.1359 14.5406 15.3844 14.4469 15.7594L12.7594 22.6453L11.1984 16.8375L12.0703 15.3844C12.3703 14.8828 12.0094 14.25 11.4281 14.25H9.57656C8.99531 14.25 8.63438 14.8875 8.93438 15.3844H8.92969Z"
            fill="#333333"
          />
        </g>
        <defs>
          <clipPath id="clip0_497_979">
            <rect width="21" height="24" fill="white" />
          </clipPath>
        </defs>
      </svg>
    ),
  },
  {
    href: "/attendance",
    label: "Attendance Tracking",
    icon: (
      <svg
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M8 14H16M8 10H10M8 18H12M10 3H6C5.46957 3 4.96086 3.21071 4.58579 3.58579C4.21071 3.96086 4 4.46957 4 5V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V5C20 4.46957 19.7893 3.96086 19.4142 3.58579C19.0391 3.21071 18.5304 3 18 3H14.5M10 3V1M10 3V5"
          stroke="#333333"
          strokeWidth="1.5"
          strokeLinecap="round"
          strokeLinejoin="round"
        />
      </svg>
    ),
  },
  {
    href: "/employees",
    label: "Employee Management",
    icon: (
      <svg
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M20 7V21C20 21.2652 19.8946 21.5196 19.7071 21.7071C19.5196 21.8946 19.2652 22 19 22H5C4.73478 22 4.48043 21.8946 4.29289 21.7071C4.10536 21.5196 4 21.2652 4 21V3C4 2.73478 4.10536 2.48043 4.29289 2.29289C4.48043 2.10536 4.73478 2 5 2H15M20 7H15V2M20 7L15 2"
          stroke="#333333"
          strokeWidth="1.83333"
          strokeLinecap="round"
          strokeLinejoin="round"
        />
        <path
          d="M12 14C13.1046 14 14 13.1046 14 12C14 10.8954 13.1046 10 12 10C10.8954 10 10 10.8954 10 12C10 13.1046 10.8954 14 12 14Z"
          stroke="#333333"
          strokeWidth="1.83333"
          strokeLinecap="round"
          strokeLinejoin="round"
        />
        <path
          d="M16 18C16 16.9391 15.5786 15.9217 14.8284 15.1716C14.0783 14.4214 13.0609 14 12 14C10.9391 14 9.92172 14.4214 9.17157 15.1716C8.42143 15.9217 8 16.9391 8 18"
          stroke="#333333"
          strokeWidth="1.83333"
          strokeLinecap="round"
          strokeLinejoin="round"
        />
      </svg>
    ),
  },
  {
    href: "/revenue",
    label: "Revenue Management",
    icon: (
      <svg
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <g clipPath="url(#clip0_497_1014)">
          <path
            d="M2.5 13C5.43 9.5205 8.092 7.517 9.3065 6.694C9.7035 6.4245 10.227 6.5125 10.5285 6.8855C11.1011 7.59891 11.653 8.32872 12.1835 9.074C12.5875 9.64 13.44 9.658 13.8875 9.126C15.9555 6.67 18.7505 4.25 18.7505 4.25"
            stroke="#333333"
            strokeWidth="1.5"
            strokeLinecap="round"
            strokeLinejoin="round"
          />
          <path
            d="M21.188 5.6619C21.52 4.0444 21.5165 2.6184 21.4885 1.9469C21.4848 1.83281 21.4378 1.7244 21.3571 1.64363C21.2764 1.56286 21.1681 1.51577 21.054 1.5119C19.8082 1.46562 18.5612 1.56648 17.339 1.8124C16.9625 1.8894 16.838 2.3499 17.109 2.6214L20.379 5.8914C20.651 6.1629 21.111 6.0379 21.188 5.6619ZM2.6335 22.4804C2.0695 22.4619 1.6375 22.1209 1.5805 21.5599C1.535 21.1199 1.5 20.4664 1.5 19.5004C1.5 18.5344 1.536 17.8804 1.58 17.4409C1.6375 16.8799 2.0695 16.5389 2.6335 16.5199C2.967 16.5089 3.4135 16.5004 4 16.5004C4.5865 16.5004 5.033 16.5089 5.3665 16.5204C5.9305 16.5389 6.3625 16.8799 6.4195 17.4409C6.4645 17.8809 6.5 18.5344 6.5 19.5004C6.5 20.4664 6.464 21.1204 6.42 21.5599C6.3625 22.1209 5.9305 22.4619 5.3665 22.4809C5.0325 22.4919 4.5865 22.5004 4 22.5004C3.4135 22.5004 2.967 22.4919 2.6335 22.4804ZM18.7785 22.4674C18.1285 22.4274 17.677 21.9584 17.63 21.3089C17.566 20.4284 17.5 18.8339 17.5 16.0004C17.5 13.1669 17.566 11.5724 17.63 10.6919C17.677 10.0424 18.1285 9.5729 18.7785 9.5334C19.0935 9.5139 19.495 9.5004 20 9.5004C20.505 9.5004 20.9065 9.5139 21.2215 9.5334C21.8715 9.5734 22.323 10.0424 22.37 10.6919C22.434 11.5724 22.5 13.1669 22.5 16.0004C22.5 18.8339 22.434 20.4284 22.37 21.3089C22.323 21.9584 21.8715 22.4279 21.2215 22.4674C20.9065 22.4869 20.5055 22.5004 20 22.5004C19.495 22.5004 19.0935 22.4869 18.7785 22.4674ZM10.75 22.4764C10.118 22.4489 9.6565 22.0264 9.6035 21.3964C9.549 20.7474 9.5 19.6934 9.5 18.0004C9.5 16.3074 9.549 15.2534 9.6035 14.6044C9.6565 13.9744 10.118 13.5519 10.7495 13.5244C11.1661 13.5073 11.583 13.4993 12 13.5004C12.521 13.5004 12.931 13.5104 13.25 13.5244C13.882 13.5519 14.3435 13.9744 14.3965 14.6044C14.451 15.2534 14.5 16.3074 14.5 18.0004C14.5 19.6934 14.451 20.7474 14.3965 21.3964C14.3435 22.0264 13.882 22.4489 13.2505 22.4764C12.931 22.4904 12.521 22.5004 12 22.5004C11.5832 22.5014 11.1664 22.4934 10.75 22.4764Z"
            stroke="#333333"
            strokeWidth="1.5"
            strokeLinecap="round"
            strokeLinejoin="round"
          />
        </g>
        <defs>
          <clipPath id="clip0_497_1014">
            <rect width="24" height="24" fill="white" />
          </clipPath>
        </defs>
      </svg>
    ),
  },
  {
    href: "/expenses",
    label: "Expense Management & Profit",
    icon: (
      <svg
        width="16"
        height="16"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M9 21.75H15M13.5 7.5L11.25 9.75L12.75 11.25L10.5 13.5M19.5 9.75V11.25C19.5 12.45 18.4995 13.7505 18 14.25L15.75 16.5L15 18.75H9L8.25 16.5L6 14.25C5.5005 13.7505 4.5 12.45 4.5 11.25V9.75C4.5 7.76088 5.29018 5.85322 6.6967 4.4467C8.10322 3.04018 10.0109 2.25 12 2.25C13.9891 2.25 15.8968 3.04018 17.3033 4.4467C18.7098 5.85322 19.5 7.76088 19.5 9.75Z"
          stroke="#333333"
          strokeWidth="1.375"
        />
      </svg>
    ),
  },
  {
    href: "/workouts",
    label: "Workout Management",
    icon: (
      <svg
        width="16"
        height="16"
        viewBox="0 0 25 13"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M3.98797 1.73364C4.00626 1.13605 4.43369 0.601333 5.1834 0.532119C5.3994 0.512667 5.6474 0.5 5.92969 0.5C6.21197 0.5 6.45997 0.512666 6.67597 0.532571C7.42626 0.601333 7.85312 1.13605 7.8714 1.73364C7.89826 2.61307 7.92969 4.12674 7.92969 6.38095C7.92969 8.63517 7.89826 10.1488 7.8714 11.0283C7.85312 11.6259 7.42569 12.1606 6.67597 12.2298C6.45997 12.2492 6.21197 12.2619 5.92969 12.2619C5.6474 12.2619 5.3994 12.2492 5.1834 12.2298C4.43312 12.1606 4.00626 11.6259 3.98797 11.0283C3.96112 10.1488 3.92969 8.63517 3.92969 6.38095C3.92969 4.12674 3.96112 2.61307 3.98797 1.73364ZM21.0143 1.73364C20.996 1.13605 20.5685 0.601333 19.8188 0.532119C19.6028 0.512667 19.3548 0.5 19.0725 0.5C18.7903 0.5 18.5423 0.512666 18.3263 0.532571C17.576 0.601333 17.1491 1.13605 17.1308 1.73364C17.104 2.61307 17.0725 4.12674 17.0725 6.38095C17.0725 8.63517 17.104 10.1488 17.1308 11.0283C17.1491 11.6259 17.5765 12.1606 18.3263 12.2298C18.5423 12.2492 18.7903 12.2619 19.0725 12.2619C19.3548 12.2619 19.6028 12.2492 19.8188 12.2298C20.5691 12.1606 20.996 11.6259 21.0143 11.0283C21.0411 10.1488 21.0725 8.63517 21.0725 6.38095C21.0725 4.12674 21.0411 2.61307 21.0143 1.73364Z"
          fill="#333333"
          stroke="#333333"
          strokeLinecap="round"
          strokeLinejoin="round"
        />
        <path
          d="M7.92457 7.7319C10.9748 7.74489 14.0252 7.74293 17.0754 7.72602ZM17.0749 5.03933C15.6954 5.03164 13.9891 5.02576 11.928 5.02576C10.4034 5.02576 9.072 5.02892 7.924 5.0339M0.531429 4.03187C0.552 3.35783 1.09371 2.78873 1.94514 2.76702C2.12453 2.76256 2.30404 2.76256 2.48343 2.76702C3.33486 2.78873 3.87657 3.35737 3.89714 4.03187C3.91429 4.58514 3.92857 5.36007 3.92857 6.3829C3.92857 7.40573 3.91371 8.18066 3.89714 8.73392C3.87657 9.40797 3.33486 9.97707 2.48343 9.99878C2.30404 10.0032 2.12453 10.0032 1.94514 9.99878C1.09371 9.97707 0.552 9.40842 0.531429 8.73392C0.514286 8.18066 0.5 7.40573 0.5 6.3829C0.5 5.36007 0.514857 4.58514 0.531429 4.03187ZM24.4686 4.03187C24.448 3.35783 23.9063 2.78873 23.0549 2.76702C22.8755 2.76256 22.696 2.76256 22.5166 2.76702C21.6651 2.78873 21.1234 3.35737 21.1029 4.03187C21.0857 4.58514 21.0714 5.36007 21.0714 6.3829C21.0714 7.40573 21.0863 8.18066 21.1029 8.73392C21.1234 9.40797 21.6651 9.97707 22.5166 9.99878C22.696 10.0032 22.8755 10.0032 23.0549 9.99878C23.9063 9.97707 24.448 9.40842 24.4686 8.73392C24.4857 8.18066 24.5 7.40573 24.5 6.3829C24.5 5.36007 24.4851 4.58514 24.4686 4.03187Z"
          fill="#333333"
        />
        <path
          d="M7.92457 7.7319C10.9748 7.74489 14.0252 7.74293 17.0754 7.72602M17.0749 5.03933C15.6954 5.03164 13.9891 5.02576 11.928 5.02576C10.4034 5.02576 9.072 5.02892 7.924 5.0339M0.531429 4.03187C0.552 3.35783 1.09371 2.78873 1.94514 2.76702C2.12453 2.76256 2.30404 2.76256 2.48343 2.76702C3.33486 2.78873 3.87657 3.35737 3.89714 4.03187C3.91429 4.58514 3.92857 5.36007 3.92857 6.3829C3.92857 7.40573 3.91371 8.18066 3.89714 8.73392C3.87657 9.40797 3.33486 9.97707 2.48343 9.99878C2.30404 10.0032 2.12453 10.0032 1.94514 9.99878C1.09371 9.97707 0.552 9.40842 0.531429 8.73392C0.514286 8.18066 0.5 7.40573 0.5 6.3829C0.5 5.36007 0.514857 4.58514 0.531429 4.03187ZM24.4686 4.03187C24.448 3.35783 23.9063 2.78873 23.0549 2.76702C22.8755 2.76256 22.696 2.76256 22.5166 2.76702C21.6651 2.78873 21.1234 3.35737 21.1029 4.03187C21.0857 4.58514 21.0714 5.36007 21.0714 6.3829C21.0714 7.40573 21.0863 8.18066 21.1029 8.73392C21.1234 9.40797 21.6651 9.97707 22.5166 9.99878C22.696 10.0032 22.8755 10.0032 23.0549 9.99878C23.9063 9.97707 24.448 9.40842 24.4686 8.73392C24.4857 8.18066 24.5 7.40573 24.5 6.3829C24.5 5.36007 24.4851 4.58514 24.4686 4.03187Z"
          stroke="#333333"
          strokeLinecap="round"
          strokeLinejoin="round"
        />
      </svg>
    ),
  },
];

export default function Sidebar() {
  const router = useRouter();
  const pathname = usePathname();
  const [currentUser, setCurrentUser] = useState<User | null>(null);
  const [loading, setLoading] = useState(true);
  const [isOpen, setIsOpen] = useState(false);

  // Close sidebar when route changes
  useEffect(() => {
    setIsOpen(false);
  }, [pathname]);

  // Close sidebar when clicking outside
  useEffect(() => {
    const handleClickOutside = (event: MouseEvent) => {
      const target = event.target as HTMLElement;
      if (
        isOpen &&
        !target.closest(".sidebar") &&
        !target.closest(".menu-button")
      ) {
        setIsOpen(false);
      }
    };

    document.addEventListener("mousedown", handleClickOutside);
    return () => {
      document.removeEventListener("mousedown", handleClickOutside);
    };
  }, [isOpen]);

  useEffect(() => {
    const fetchUser = async () => {
      try {
        const response = await authService.getCurrentUser();
        setCurrentUser(response.user);
      } catch (error) {
        console.error("Failed to fetch user:", error);
        setCurrentUser(null);
      } finally {
        setLoading(false);
      }
    };

    fetchUser();
  }, []);

  const handleLogout = async () => {
    try {
      // Call backend to clear the access_token cookie
      await authService.logout();
      await fetch("/api/logout", {
        method: "POST",
        credentials: "include",
      });
    } catch (error) {
      console.error("Logout failed:", error);
    } finally {
      // Navigate to signin page (proxy will allow this since cookie is cleared)
      router.push("/signup");
    }
  };
  // Mobile menu button component
  const MenuButton = () => (
    <button
      onClick={() => setIsOpen(!isOpen)}
      className="fixed  block lg:hidden  top-1 left-2 z-50 p-2 rounded-md bg-[#28A745] text-white shadow-lg menu-button"
      aria-label={isOpen ? "Close menu" : "Open menu"}
    >
      {isOpen ? (
        <svg
          className="w-6 h-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            strokeLinecap="round"
            strokeLinejoin="round"
            strokeWidth={2}
            d="M6 18L18 6M6 6l12 12"
          />
        </svg>
      ) : (
        <svg
          className="w-6 h-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            strokeLinecap="round"
            strokeLinejoin="round"
            strokeWidth={2}
            d="M4 6h16M4 12h16M4 18h16"
          />
        </svg>
      )}
    </button>
  );

  return (
    <>
      <MenuButton />
      {/* Overlay */}
      <div
        className={`fixed inset-0 bg-black/80 bg-opacity-50 z-40 transition-opacity duration-300 ${
          isOpen ? "opacity-100" : "opacity-0 pointer-events-none"
        } md:hidden`}
        onClick={() => setIsOpen(false)}
      />
      <aside
        className={`sidebar fixed lg:sticky top-0 left-0 h-screen bg-[#D6E2D9] p-4 w-64 z-50 transition-transform duration-300 ease-in-out ${
          isOpen ? "translate-x-0" : "-translate-x-full lg:translate-x-0"
        }`}
      >
        <div className="flex flex-col items-center gap-2 mb-6">
          <div className="text-2xl font-bold">WellVantage</div>
        </div>
        <nav className="flex flex-col gap-2 overflow-auto h-[calc(100%-177px)]">
          {items.map((i) => {
            const active =
              pathname === i.href ||
              (i.href !== "/" && pathname.startsWith(i.href));
            return (
              <Link
                key={i.label}
                href={i.href}
                aria-current={active ? "page" : undefined}
                className={
                  "flex items-center gap-3 px-3 py-2 rounded-lg text-sm transition-all duration-300 " +
                  (active
                    ? "bg-[#28A745] text-white"
                    : "text-gray-800 hover:bg-[#28A745] hover:text-white group")
                }
              >
                <span className="text-base w-5 text-center" aria-hidden>
                  {i.icon}
                </span>
                <span className="truncate">{i.label}</span>
              </Link>
            );
          })}
        </nav>
        <div className="absolute bottom-4 left-4 right-4">
          <div className="flex items-center gap-3 p-3 rounded-xl bg-[#28A74545] border border-[#28A7454F] ">
            {currentUser?.profilePicture ? (
              <img
                src={currentUser.profilePicture}
                alt={`${currentUser.firstName} ${currentUser.lastName}`}
                className="h-8 w-8 rounded-full object-cover border"
              />
            ) : (
              <div className="h-8 w-8 rounded-full bg-white border flex items-center justify-center text-gray-600 text-xs font-semibold">
                {loading
                  ? "..."
                  : currentUser
                  ? `${currentUser.firstName}${currentUser.lastName}`
                  : "?"}
              </div>
            )}
            <div className="text-sm font-medium">
              {loading
                ? "Loading..."
                : currentUser
                ? `${currentUser.firstName} ${currentUser.lastName}`
                : "Guest"}
            </div>
          </div>
          <button
            onClick={handleLogout}
            className="mt-3 w-full h-10 rounded-md text-gray-700 flex items-center gap-2 hover:bg-[#28A745] hover:text-white cursor-pointer px-3"
          >
            <svg
              width="21"
              height="21"
              viewBox="0 0 21 21"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M18.4224 15.2344H16.7747C16.6622 15.2344 16.5568 15.2836 16.4865 15.3703C16.3224 15.5696 16.1466 15.7618 15.9615 15.9446C15.2042 16.7026 14.3072 17.3067 13.3201 17.7235C12.2974 18.1554 11.1982 18.377 10.088 18.375C8.96537 18.375 7.87787 18.1547 6.85599 17.7235C5.86886 17.3067 4.97185 16.7026 4.21458 15.9446C3.45596 15.1891 2.85104 14.2936 2.43333 13.3078C1.99974 12.286 1.78177 11.2008 1.78177 10.0782C1.78177 8.9555 2.00208 7.87035 2.43333 6.84847C2.85052 5.86175 3.45052 4.97347 4.21458 4.21175C4.97865 3.45004 5.86693 2.85004 6.85599 2.43285C7.87787 2.0016 8.96537 1.78129 10.088 1.78129C11.2107 1.78129 12.2982 1.99925 13.3201 2.43285C14.3091 2.85004 15.1974 3.45004 15.9615 4.21175C16.1466 4.39691 16.3201 4.5891 16.4865 4.78597C16.5568 4.87269 16.6646 4.92191 16.7747 4.92191H18.4224C18.5701 4.92191 18.6615 4.75785 18.5794 4.63363C16.7818 1.83988 13.6365 -0.00933952 10.0622 3.54813e-05C4.44661 0.014098 -0.0557286 4.57269 0.000521378 10.1813C0.0567714 15.7008 4.55208 20.1563 10.088 20.1563C13.6529 20.1563 16.7841 18.3094 18.5794 15.5227C18.6591 15.3985 18.5701 15.2344 18.4224 15.2344ZM20.506 9.9305L17.1802 7.3055C17.056 7.20707 16.8755 7.29613 16.8755 7.45316V9.23441H9.51615C9.41302 9.23441 9.32865 9.31879 9.32865 9.42191V10.7344C9.32865 10.8375 9.41302 10.9219 9.51615 10.9219H16.8755V12.7032C16.8755 12.8602 17.0583 12.9493 17.1802 12.8508L20.506 10.2258C20.5284 10.2083 20.5465 10.1859 20.559 10.1603C20.5715 10.1347 20.5779 10.1066 20.5779 10.0782C20.5779 10.0497 20.5715 10.0216 20.559 9.99604C20.5465 9.97045 20.5284 9.94804 20.506 9.9305Z"
                fill="#333333"
              />
            </svg>
            Logout
          </button>
        </div>
      </aside>
    </>
  );
}
